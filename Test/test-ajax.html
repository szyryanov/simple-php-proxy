<!DOCTYPE html>
<html lang="ru">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>simple-php-proxy AJAX tests</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
</head>
<body>

  <h2>simple-php-proxy - AJAX test</h2>
  <div class="result"></div>

  <script src="https://code.jquery.com/jquery-1.12.4.min.js"	integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ="	crossorigin="anonymous"></script>

  <script>
  
    $().ready(function(){
      
        $.ajax({
            method: 'POST',
            url: "http://projects/simple-php-proxy/Test/simple-php-proxy.php?url=Test/return-post.php",
            data: {'key1': 'value1', 'key2': 'value2'}, 
        })        
        .done(function(data) {
          var resume = 'ERROR';
          data = removeSpaces(data);
          if (data == 'Array([key1]=>value1[key2]=>value2)') resume = 'ok';
          appendResult('POST: ' + data + ' - ' + resume);
        })
        .fail(function() {
          appendResult('POST - failed');
        });
        
        var url = 'http://projects/simple-php-proxy/Test/simple-php-proxy.php?url=Test/return-url.php?a=b&c=d&e=f';
        url = url.replace(/&/g, '%26');
        $.ajax({
            method: 'GET',
            url: url, //"http://projects/simple-php-proxy/Test/simple-php-proxy.php?url=Test/return-url.php?a=b%26c=d",  // '&' inside the "url" parm is replaced to '%26'!
        })        
        .done(function(data) {
          var resume = 'ERROR';
          if (data == 'projects/simple-php-proxy/Test/return-url.php?a=b&c=d&e=f') resume = 'ok';
          appendResult('GET: ' + data + ' - ' + resume);
        })
        .fail(function() {
          appendResult('GET - failed');
        });
        
        function appendResult(text){
          $(".result").append('<p>' + text + '</p>');
        }
        
        function removeSpaces(text){
          return text.replace(/[\r\n ]/g, '');
        }
      
    });
  
  </script>
  
  

</body>
</html>
